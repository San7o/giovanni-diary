<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="/simple.css" />
<link rel="stylesheet" href="/giovanni-diary/simple.css" />
<meta property="og:title" content="Giovanni's Diary">
<meta property="og:description" content="Diary of Giovanni's adventures.">
<meta property="og:image" content="https://giovanni-diary.netlify.app/logo.png">
<meta property="og:url" content="https://giovanni-diary.netlify.app/">
</head>
<body>
<div id="content" class="content">
<p>
<a href="../../../index.html">Giovanni's Diary</a> &gt; <a href="../../../subjects.html">Subjects</a> &gt; <a href="../../programming.html">Programming</a> &gt; <a href="../gists.html">Gists</a> &gt;
</p>

<div id="outline-container-org504e51c" class="outline-2">
<h2 id="org504e51c">C / CMakeLists.txt</h2>
<div class="outline-text-2" id="text-org504e51c">
<p>
Modern Cmake template for C++ projects.
</p>

<div class="org-src-container">
<pre class="src src-c"># ====================================================================
<span style="color: #b0c4de;"># Project</span>:   myproject
<span style="color: #b0c4de;"># Author</span>:    Giovanni Santini
<span style="color: #b0c4de;"># Mail</span>:      giovanni.santini@proton.me
<span style="color: #b0c4de;"># Github</span>:    @San7o
<span style="color: #b0c4de;"># License</span>:   MIT
# ====================================================================

cmake_minimum_required(VERSION 3.16)

<span style="color: #87cefa;">project</span>(<span style="color: #98fb98;">myproject</span>
  <span style="color: #eedd82;">VERSION</span> 1.0
  DESCRIPTION <span style="color: #ffa07a;">"C++ project with Cmake"</span>
  LANGUAGES CXX
)

<span style="color: #87cefa;">set</span>(CMAKE_CXX_STANDARD 17)
<span style="color: #87cefa;">set</span>(<span style="color: #98fb98;">CMAKE_CXX_STANDARD_REQUIRED</span> <span style="color: #eedd82;">ON</span>)
<span style="color: #87cefa;">set</span>(<span style="color: #98fb98;">CMAKE_CXX_EXTENSIONS</span> <span style="color: #eedd82;">OFF</span>)  # no gnu extensions

find_program(CCACHE_PROGRAM ccache) # use ccache <span style="color: #00ffff;">if</span> available
<span style="color: #00ffff;">if</span>(CCACHE_PROGRAM)
  <span style="color: #87cefa;">message</span>(STATUS <span style="color: #ffa07a;">"Using ccache: ${CCACHE_PROGRAM}"</span>)
  <span style="color: #87cefa;">set</span>(CMAKE_CXX_COMPILER_LAUNCHER <span style="color: #ffa07a;">"${CCACHE_PROGRAM}"</span>)
<span style="color: #87cefa;">endif</span>()

<span style="color: #00ffff;">if</span>(MSVC)
  <span style="color: #87cefa;">set</span>(WARNING_FLAGS /W4 /permissive-)
  <span style="color: #87cefa;">set</span>(DEBUG_FLAGS /Zi /Od)
  <span style="color: #87cefa;">set</span>(RELEASE_FLAGS /O2)
  <span style="color: #87cefa;">set</span>(<span style="color: #98fb98;">DEBUG_DEFINES</span> <span style="color: #eedd82;">_DEBUG</span>)
<span style="color: #00ffff;">else</span>()
  <span style="color: #87cefa;">set</span>(WARNING_FLAGS -Wall -Wextra -Werror -Wpedantic)
  <span style="color: #87cefa;">set</span>(DEBUG_FLAGS -O0 -ggdb -fsanitize=address)
  <span style="color: #87cefa;">set</span>(RELEASE_FLAGS -O3)
  <span style="color: #87cefa;">set</span>(<span style="color: #98fb98;">DEBUG_DEFINES</span> <span style="color: #eedd82;">DEBUG</span>)
  <span style="color: #87cefa;">set</span>(DEBUG_LINK_FLAGS -fsanitize=address)
<span style="color: #87cefa;">endif</span>()

#
<span style="color: #b0c4de;"># Options</span>
#

<span style="color: #b0c4de;">#option</span>(BUILD_SHARED_LIBS <span style="color: #ffa07a;">"Build libraries as shared"</span> ON)
option(ENABLE_TESTING <span style="color: #ffa07a;">"Enable unit tests"</span> ON)

<span style="color: #00ffff;">if</span>(NOT CMAKE_BUILD_TYPE)
  <span style="color: #87cefa;">set</span>(<span style="color: #98fb98;">CMAKE_BUILD_TYPE</span> Release <span style="color: #98fb98;">CACHE</span> <span style="color: #eedd82;">STRING</span> <span style="color: #ffa07a;">"Build type (Debug, Release)"</span> FORCE)
<span style="color: #87cefa;">endif</span>()
<span style="color: #87cefa;">message</span>(STATUS <span style="color: #ffa07a;">"Build type: ${CMAKE_BUILD_TYPE}"</span>)

#
<span style="color: #b0c4de;"># Dependencies</span>
#

<span style="color: #b0c4de;"># add_subdirectory</span>(external/SFML)

#
<span style="color: #b0c4de;"># Sources</span> and headers
#

set(SOURCES src/main.cpp)
<span style="color: #b0c4de;">#set</span>(HEADERS include/myproject.hpp)

#
<span style="color: #b0c4de;"># Targets</span>
#

add_executable(${PROJECT_NAME} ${SOURCES} ${HEADERS})
target_include_directories(${PROJECT_NAME}
  PRIVATE ${PROJECT_SOURCE_DIR}/include)

<span style="color: #00ffff;">if</span>(CMAKE_BUILD_TYPE STREQUAL <span style="color: #ffa07a;">"Debug"</span>)
  <span style="color: #87cefa;">message</span>(STATUS <span style="color: #ffa07a;">"Configuring Debug build options..."</span>)

  target_compile_definitions(${PROJECT_NAME} PRIVATE ${DEBUG_DEFINES})
  target_compile_options(${PROJECT_NAME}
    PRIVATE ${DEBUG_FLAGS} ${WARNING_FLAGS})
  <span style="color: #00ffff;">if</span>(NOT MSVC)
    target_link_options(${PROJECT_NAME} PRIVATE ${DEBUG_LINK_FLAGS})
  <span style="color: #87cefa;">endif</span>()
<span style="color: #87cefa;">elseif</span>(<span style="color: #98fb98;">CMAKE_BUILD_TYPE</span> <span style="color: #eedd82;">STREQUAL</span> <span style="color: #ffa07a;">"Release"</span>)
  <span style="color: #87cefa;">message</span>(STATUS <span style="color: #ffa07a;">"Configuring Release build options..."</span>)
  target_compile_options(${PROJECT_NAME}
    PRIVATE ${RELEASE_FLAGS} ${WARNING_FLAGS})
<span style="color: #87cefa;">endif</span>()

#
<span style="color: #b0c4de;"># Installation</span>
#

install(TARGETS ${PROJECT_NAME}
  RUNTIME DESTINATION bin
)
<span style="color: #87cefa;">install</span>(<span style="color: #98fb98;">DIRECTORY</span> <span style="color: #eedd82;">include</span>/ DESTINATION include)

#
<span style="color: #b0c4de;"># Testing</span>
#

<span style="color: #00ffff;">if</span>(ENABLE_TESTING)
  <span style="color: #87cefa;">message</span>(WARNING <span style="color: #ffa07a;">"Tests not present"</span>)

<span style="color: #b0c4de;">  #include</span>(CTest)
<span style="color: #b0c4de;">  #enable_testing</span>()

<span style="color: #b0c4de;">  #add_executable</span>(tests test/test_main.cpp)
<span style="color: #b0c4de;">  #target_link_libraries</span>(tests PRIVATE ${PROJECT_NAME})

<span style="color: #b0c4de;">  #add_test</span>(NAME MyTests COMMAND tests)
<span style="color: #87cefa;">endif</span>()

#
<span style="color: #b0c4de;"># Packaging</span> support
#

include(CMakePackageConfigHelpers)

write_basic_package_version_file(
  <span style="color: #ffa07a;">"${CMAKE_CURRENT_BINARY_DIR}/${PROJECT_NAME}ConfigVersion.cmake"</span>
  VERSION ${PROJECT_VERSION}
  COMPATIBILITY AnyNewerVersion
)

#
<span style="color: #b0c4de;"># End</span> of CMakeLists.txt
# ====================================================================
</pre>
</div>


<hr />

<p>
Travel: <a href="../gists.html">Gists</a>, <a href="../../../theindex.html">Index</a>
</p>
</div>
</div>
</div>
</body>
</html>
